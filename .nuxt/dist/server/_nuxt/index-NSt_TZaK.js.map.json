{"file":"index-NSt_TZaK.js","mappings":"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","names":["_ssrRenderComponent","_mergeProps","_push","_parent","_","_scopeId","_createVNode","_unref","_createBlock","list"],"sources":["../../../../pages/index.vue"],"sourcesContent":["<template>\n\t<v-row\n\t\tclass=\"fill-height ma-0 align-center justify-center bg-grey-lighten-3\">\n\t\t<v-col class=\"pa-0 h-100 d-flex flex-column overflow-hidden\">\n\t\t\t<div\n\t\t\t\tstyle=\"height: 15em\"\n\t\t\t\tclass=\"d-flex align-center justify-center flex-column ga-2\">\n\t\t\t\t<v-btn\n\t\t\t\t\tv-if=\"!isScanning\"\n\t\t\t\t\tvariant=\"text\"\n\t\t\t\t\tstyle=\"\n\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\tmax-width: 360px;\n\t\t\t\t\t\theight: 96px;\n\t\t\t\t\t\tborder: 2px dashed #ccc;\n\t\t\t\t\t\"\n\t\t\t\t\t@click=\"startScan\">\n\t\t\t\t\t<div class=\"d-flex flex-column align-center justify-center\">\n\t\t\t\t\t\t<v-icon\n\t\t\t\t\t\t\tsize=\"64\"\n\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\ticon=\"mdi-barcode-scan\" />\n\t\t\t\t\t\t<span class=\"text-h6 font-medium\"\n\t\t\t\t\t\t\t>點擊開始掃描 ISBN</span\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</v-btn>\n\n\t\t\t\t<v-card\n\t\t\t\t\tv-else\n\t\t\t\t\tclass=\"w-100 h-100 d-flex flex-column\"\n\t\t\t\t\televation=\"4\">\n\t\t\t\t\t<v-toolbar\n\t\t\t\t\t\tcolor=\"white\"\n\t\t\t\t\t\tdensity=\"compact\"\n\t\t\t\t\t\tstyle=\"height: 48px; flex-shrink: 0\">\n\t\t\t\t\t\t<v-spacer />\n\t\t\t\t\t\t<v-btn\n\t\t\t\t\t\t\ticon=\"mdi-close\"\n\t\t\t\t\t\t\t@click=\"stopScan\" />\n\t\t\t\t\t</v-toolbar>\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"flex-grow-1 overflow-hidden d-flex align-center justify-center bg-black\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tid=\"scanner\"\n\t\t\t\t\t\t\tclass=\"w-100 h-100\"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<!-- 提示文字不撐高 -->\n\t\t\t\t\t<v-card-text class=\"text-center py-1 flex-shrink-0\">\n\t\t\t\t\t\t<v-chip\n\t\t\t\t\t\t\tprepend-icon=\"mdi-information\"\n\t\t\t\t\t\t\tvariant=\"text\">\n\t\t\t\t\t\t\t請將書籍背面的 ISBN 條碼對準對焦框\n\t\t\t\t\t\t</v-chip>\n\t\t\t\t\t</v-card-text>\n\t\t\t\t</v-card>\n\t\t\t</div>\n\n\t\t\t<v-divider />\n\n\t\t\t<v-sheet\n\t\t\t\tclass=\"flex-grow-1 d-flex flex-column align-center justify-center bg-surface\">\n\t\t\t\t<list v-if=\"isbnStore.results.length > 0\"></list>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<v-icon\n\t\t\t\t\t\tsize=\"64\"\n\t\t\t\t\t\tcolor=\"grey-lighten-2\"\n\t\t\t\t\t\ticon=\"mdi-book-open-variant\" />\n\t\t\t\t\t<div class=\"text-h6 text-medium-emphasis mt-4 text-center\">\n\t\t\t\t\t\t請將 ISBN 條碼置於畫面中央\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"text-caption text-grey-darken-1 mt-2\">\n\t\t\t\t\t\t掃描完成後將自動顯示書籍資訊\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</v-sheet>\n\t\t</v-col>\n\t</v-row>\n</template>\n\n<script setup>\n\timport { ref, nextTick } from 'vue';\n\timport { Html5Qrcode } from 'html5-qrcode';\n\timport isbn from 'isbn3';\n\timport { useIsbnStore } from '~/stores/isbnStore';\n\timport list from './list.vue';\n\n\tconst isbnStore = useIsbnStore();\n\tconst isScanning = ref(false);\n\tisbnStore.addResult('9789571375673'); // for test\n\tconsole.log(isbnStore.results);\n\tconst hasList = isbnStore.results.length > 0;\n\tlet html5QrCode = null;\n\n\tconst startScan = async () => {\n\t\tisScanning.value = true;\n\t\tawait nextTick();\n\n\t\thtml5QrCode = new Html5Qrcode('scanner');\n\n\t\tawait html5QrCode.start(\n\t\t\t{\n\t\t\t\tfacingMode: 'environment', // 後鏡頭\n\t\t\t},\n\t\t\t{\n\t\t\t\tfps: 10,\n\t\t\t\t// 強制要求 1:1 或特定的寬高比有助於計算中心點\n\t\t\t\taspectRatio: 1.0,\n\t\t\t\tqrbox: (vw, vh) => {\n\t\t\t\t\t// 這裡的 vw, vh 是掃描容器的寬高\n\t\t\t\t\tconst width = Math.min(vw * 0.8, 300);\n\t\t\t\t\tconst height = width * 0.4; // 適合 ISBN 的長方形\n\t\t\t\t\treturn { width, height };\n\t\t\t\t},\n\t\t\t\tdisableFlip: true,\n\t\t\t},\n\t\t\t(decodedText) => {\n\t\t\t\tconst parsed = isbn.parse(decodedText);\n\t\t\t\tif (parsed) {\n\t\t\t\t\tisbnStore.addResult(parsed.isbn13);\n\t\t\t\t\t// stopScan();\n\t\t\t\t\t// navigateTo('/list');\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t};\n\n\tconst stopScan = async () => {\n\t\tif (html5QrCode) {\n\t\t\tawait html5QrCode.stop();\n\t\t\tawait html5QrCode.clear();\n\t\t\thtml5QrCode = null;\n\t\t}\n\t\tisScanning.value = false;\n\t};\n</script>\n<style scoped>\n\t/* 1. 強制讓套件產生的 video 填滿容器並保持置中 */\n\t#scanner :deep(video) {\n\t\twidth: 100% !important;\n\t\theight: 100% !important;\n\t\tobject-fit: cover;\n\t\t/* 讓相機畫面填滿整個區域，不留黑邊 */\n\t}\n\n\t/* 2. 處理套件產生的中間層容器 (通常是個 div) */\n\t#scanner :deep(div) {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tposition: relative;\n\t}\n\n\t/* 3. 修正對焦框 (qrbox) 的位置 */\n\t#scanner :deep(canvas) {\n\t\tposition: absolute;\n\t\ttop: 50% !important;\n\t\tleft: 50% !important;\n\t\ttransform: translate(-50%, -50%) !important;\n\t}\n</style>\n"],"version":3}